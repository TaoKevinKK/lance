[2025-06-24T13:17:18Z DEBUG lance_file::v2::writer] write_batch called with 437773399 bytes of data
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 0 page of size 32000096 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 405773303 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 3623902 bytes
[2025-06-24T13:17:18Z DEBUG lance::events] target="lance::file_audit" mode="create" type="data" path="219025d1-d262-4c47-b3ec-5d29844094a0.lance" 
[2025-06-24T13:17:18Z DEBUG lance_file::v2::writer] write_batch called with 437773399 bytes of data
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 0 page of size 32000096 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 405773303 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 3590174 bytes
[2025-06-24T13:17:18Z DEBUG lance::events] target="lance::file_audit" mode="create" type="data" path="f65a5114-2884-448c-a3e3-3d9533653d26.lance" 
[2025-06-24T13:17:18Z DEBUG lance_file::v2::writer] write_batch called with 437773399 bytes of data
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 0 page of size 32000096 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 405773303 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 3631582 bytes
[2025-06-24T13:17:18Z DEBUG lance::events] target="lance::file_audit" mode="create" type="data" path="74b0acff-c676-4d25-a744-2fd89a187a0a.lance" 
[2025-06-24T13:17:18Z DEBUG lance_file::v2::writer] write_batch called with 437773399 bytes of data
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 0 page of size 32000096 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 405773303 bytes (unencoded)
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:18Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 2537182 bytes
[2025-06-24T13:17:18Z DEBUG lance::events] target="lance::file_audit" mode="create" type="data" path="4b6ed6c6-34f1-4b0a-a11f-93de64fc724e.lance" 
[2025-06-24T13:17:18Z DEBUG lance::events] target="lance::file_audit" mode="create" type="manifest" path="dummy" 
[2025-06-24T13:17:18Z INFO  lance::dataset] [DistributedIndex] Creating fragment index: type=INVERTED
[2025-06-24T13:17:18Z DEBUG sqlparser::parser] parsing expr
[2025-06-24T13:17:18Z DEBUG sqlparser::parser] prefix: Identifier(Ident { value: "text", quote_style: Some('`'), span: Span(Location(0,0)..Location(0,0)) })
[2025-06-24T13:17:18Z DEBUG sqlparser::dialect] get_next_precedence_full() TokenWithSpan { token: Word(Word { value: "FROM", quote_style: None, keyword: FROM }), span: Span(Location(0,0)..Location(0,0)) }
[2025-06-24T13:17:18Z DEBUG sqlparser::parser] next precedence: 0
[2025-06-24T13:17:18Z DEBUG lance_datafusion::exec] Executing plan:
    LanceScan: uri=tmp/lance/dataset/test.lance/data, projection=[text], row_id=true, row_addr=false, ordered=true
    
[2025-06-24T13:17:18Z INFO  lance::index::scalar] Starting index training job with id 7f7b4ebc-993e-4657-a678-dbebf57fa422 on column text
[2025-06-24T13:17:18Z INFO  lance::index::scalar] Training index (job_id=7f7b4ebc-993e-4657-a678-dbebf57fa422) on 2 selected fragments out of 4 total fragments: [0, 1]
[2025-06-24T13:17:18Z INFO  lance::index::scalar] Training index (job_id=7f7b4ebc-993e-4657-a678-dbebf57fa422): 0/2097152, all data rows: 4000000
[2025-06-24T13:17:18Z INFO  lance_index::scalar::inverted::builder] indexing FTS with 1 workers
[2025-06-24T13:17:18Z DEBUG lance::io::exec::scan] Given io_parallelism=8 and num_columns=1 we will read 16 fragments at once while scanning v2 dataset
[2025-06-24T13:17:18Z DEBUG lance::dataset::fragment] Reading v2 file: f65a5114-2884-448c-a3e3-3d9533653d26.lance by file metadata, with fragment id: 1, when create reader
[2025-06-24T13:17:18Z DEBUG lance::dataset::fragment] Reading v2 file: 219025d1-d262-4c47-b3ec-5d29844094a0.lance by file metadata, with fragment id: 0, when create reader
[2025-06-24T13:17:18Z DEBUG lance_file::v2::reader] Reading range 0..1048576 with batch_size 8192 from file with 1048576 rows and 2 columns into schema with 1 columns, func is do_read_range
[2025-06-24T13:17:18Z DEBUG lance_file::v2::reader] Reading range 0..1048576 with batch_size 8192 from file with 1048576 rows and 2 columns into schema with 1 columns, func is do_read_range
[2025-06-24T13:17:23Z INFO  lance::index::scalar] Training index (job_id=7f7b4ebc-993e-4657-a678-dbebf57fa422): 1003520/2097152
[2025-06-24T13:17:23Z DEBUG lance_index::scalar::inverted::builder] indexed 1003520 documents, elapsed: 4.952864125s, speed: 202614.08rows/s
[2025-06-24T13:17:28Z INFO  lance::index::scalar] Training index (job_id=7f7b4ebc-993e-4657-a678-dbebf57fa422): 2002944/2097152
[2025-06-24T13:17:28Z DEBUG lance_index::scalar::inverted::builder] indexed 2007040 documents, elapsed: 9.92011625s, speed: 202320.2rows/s
[2025-06-24T13:17:28Z DEBUG lance::events] target="lance::execution" type="plan_run" output_rows=2097152 iops=54 requests=54 bytes_read=221126013 indices_loaded=0 parts_loaded=0 index_comparisons=0 
[2025-06-24T13:17:28Z INFO  lance_index::scalar::inverted::builder] dispatching elapsed: 10.443920791s
[2025-06-24T13:17:28Z INFO  lance_index::scalar::inverted::builder] flushing posting lists, estimated size: 176 MiB
[2025-06-24T13:17:28Z INFO  lance_index::scalar::inverted::builder] Write partition 0 to store posting lists, tokens, docs starting
[2025-06-24T13:17:28Z INFO  lance_index::scalar::inverted::builder] writing 116 posting lists of partition 0, with position false, save to part_0_invert.lance
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 5843688 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 5900648 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 11742960 bytes (unencoded)
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 6044904 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 6033384 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 12076656 bytes (unencoded)
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 825832 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 3675641 bytes
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 1880 bytes of data
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::builder] Write tokens of partition 0, save to private/var/folders/f3/p95jw98x6vj2836b8k57kgnc0000gn/T/.tmptRrxio/part_0_tokens.lance finished
[2025-06-24T13:17:29Z DEBUG lance_file::v2::writer] write_batch called with 25166016 bytes of data
[2025-06-24T13:17:29Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 0 page of size 16777312 bytes (unencoded)
[2025-06-24T13:17:29Z DEBUG lance_encoding::encodings::logical::primitive] Flushing column 1 page of size 8388704 bytes (unencoded)
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 5242880 bytes
[2025-06-24T13:17:29Z DEBUG lance_io::object_writer] MultipartUpload submitting part with 4194711 bytes
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::builder] Write docs of partition 0, save to private/var/folders/f3/p95jw98x6vj2836b8k57kgnc0000gn/T/.tmptRrxio/part_0_docs.lance finished
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::builder] Write partition 0 to store posting lists, tokens, docs finished
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::builder] Index worker finished, processed partitions: [0]
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::builder] wait workers indexing elapsed: 328.21875ms
[2025-06-24T13:17:29Z DEBUG lance_index::scalar::lance_format] Opening index file name: part_0_tokens.lance, index_dir: private/var/folders/f3/p95jw98x6vj2836b8k57kgnc0000gn/T/.tmptRrxio
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading stream projected batch_size: 4294967295, batch_readahead: 4294967295
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading range 0..116 with batch_size 4294967295 from file with 116 rows and 2 columns into schema with 2 columns, func is do_read_range
[2025-06-24T13:17:29Z DEBUG lance_index::scalar::lance_format] Opening index file name: part_0_invert.lance, index_dir: private/var/folders/f3/p95jw98x6vj2836b8k57kgnc0000gn/T/.tmptRrxio
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading stream projected batch_size: 4294967295, batch_readahead: 4294967295
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading range 0..116 with batch_size 4294967295 from file with 116 rows and 4 columns into schema with 2 columns, func is do_read_range
[2025-06-24T13:17:29Z DEBUG lance_index::scalar::lance_format] Opening index file name: part_0_docs.lance, index_dir: private/var/folders/f3/p95jw98x6vj2836b8k57kgnc0000gn/T/.tmptRrxio
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading stream projected batch_size: 4294967295, batch_readahead: 4294967295
[2025-06-24T13:17:29Z DEBUG lance_file::v2::reader] Reading range 0..2097152 with batch_size 4294967295 from file with 2097152 rows and 2 columns into schema with 2 columns, func is do_read_range
[2025-06-24T13:17:29Z DEBUG lance_encoding::decoder] Lance read in a single batch that contained more than 24MiB of data.  You may want to consider reducing the batch size.
[2025-06-24T13:17:29Z INFO  lance_index::scalar::inverted::merger] merging copying posting file: part_0_invert.lance
